<?php ${"\x47\x4c\x4f\x42AL\x53"}["\x6f\x6fs\x76g\x6f\x78\x61\x65"]="r\x65\x73\x75\x6c\x74";${"\x47L\x4f\x42A\x4cS"}["\x77p\x70\x6bn\x6fe"]="\x6ce\x76\x65\x6c";${"\x47\x4cOBA\x4c\x53"}["\x73\x72a\x76\x6dq\x79p\x6d\x6fvo"]="c\x6fl\x75\x6d\x6es";${"\x47\x4c\x4f\x42A\x4c\x53"}["a\x70\x77\x71g\x76\x73a"]="\x74\x61\x62\x6c\x65";${"\x47\x4cO\x42\x41L\x53"}["\x6ax\x74\x63\x78n\x71\x79e\x6co\x74"]="t\x61\x62l\x65\x41\x6ci\x61\x73";${"\x47L\x4f\x42\x41L\x53"}["\x66\x64c\x73t\x61\x66\x77"]="\x69";${"\x47\x4c\x4f\x42\x41\x4cS"}["\x72wn\x76\x61\x6c\x63\x68"]="\x73q\x6c";${"\x47\x4c\x4f\x42\x41\x4c\x53"}["b\x71\x70\x77\x68q\x77\x6cg"]="f\x69\x72s\x74\x4c\x65v\x65\x6c\x54\x6f\x49nc\x6c\x75d\x65";class Nostress_Nscexport_Model_Mysql4_Cache_Categorypath extends Nostress_Nscexport_Model_Mysql4_Cache{protected$_cacheName='Category path';const DEF_MAX_LEVEL=10;const DEF_FIRST_LEVEL_TO_INCLUDE=2;const LEVEL="\x6cev\x65l";const NCCP="n\x63\x63p";public function _construct(){$this->_init("n\x73cex\x70ort/c\x61c\x68e\x5fc\x61\x74e\x67\x6fr\x79\x70\x61th","ca\x74\x65\x67\x6f\x72y_i\x64");}protected function defineColumns(){parent::defineColumns();$this->_columns[$this->getCategoryFlatTable(true)]=array("\x63a\x74\x65\x67o\x72\x79_\x69d"=>"\x65\x6et\x69ty_\x69d","s\x74o\x72\x65_\x69d"=>"({$this->getStoreId()})","c\x61\x74egory\x5fpath"=>"('\x27)","c\x61\x74e\x67\x6fry_root\x5fna\x6de"=>"('\x27)","i\x64\x73\x5fpa\x74\x68"=>"\x70ath","\x6c\x65v\x65\x6c"=>"l\x65vel");}protected function reloadTable(){${"\x47\x4c\x4fBAL\x53"}["\x71pf\x70i\x6fr"]="\x66\x69\x72\x73\x74\x4c\x65\x76\x65l\x54o\x49\x6e\x63lud\x65";${"\x47\x4c\x4f\x42\x41\x4c\x53"}["\x63o\x62\x69\x6cy\x72x\x73\x6c\x77"]="\x6d\x61xLe\x76\x65\x6c";${"GLO\x42\x41L\x53"}["ct\x66\x77\x6dfb"]="m\x61x\x4c\x65v\x65\x6c";${${"\x47\x4cOBALS"}["b\x71pw\x68\x71w\x6c\x67"]}=self::DEF_FIRST_LEVEL_TO_INCLUDE;${${"G\x4c\x4fBA\x4c\x53"}["\x63tf\x77mf\x62"]}=$this->getCategoryMaxLevel();${${"\x47\x4cO\x42\x41\x4cS"}["\x72\x77n\x76\x61l\x63\x68"]}=$this->getCategoryPathUpdateSql(${${"GL\x4f\x42\x41\x4c\x53"}["cobi\x6c\x79\x72\x78\x73\x6c\x77"]},${${"G\x4cO\x42AL\x53"}["qpfp\x69\x6f\x72"]});$this->runQuery(${${"\x47\x4c\x4f\x42\x41\x4c\x53"}["r\x77\x6e\x76\x61\x6cc\x68"]});}protected function getCategoryPathUpdateSql($maxLevel,$firstLevelToInclude){${"\x47\x4cO\x42\x41\x4c\x53"}["d\x67l\x6f\x79x\x73"]="\x6d\x61\x78\x4c\x65v\x65\x6c";${"\x47\x4cO\x42A\x4c\x53"}["\x66\x61c\x6fuz\x66\x69j"]="i";${"\x47\x4c\x4f\x42\x41LS"}["\x75k\x76tk\x64qn\x66\x6ep\x6b"]="stor\x65\x49\x64";${${"\x47\x4c\x4f\x42\x41\x4c\x53"}["u\x6bvt\x6b\x64q\x6e\x66\x6e\x70k"]}=$this->getStoreId();${"\x47\x4cO\x42AL\x53"}["\x6f\x71\x79\x64k\x66c\x72g\x68"]="\x69";${${"\x47\x4c\x4fB\x41\x4cS"}["\x72wn\x76\x61\x6cc\x68"]}=$this->getCleanCategoryPathSql();${"\x47L\x4fBA\x4c\x53"}["rc\x73\x63o\x74\x64\x76\x67p"]="\x69";${${"\x47\x4c\x4f\x42A\x4cS"}["\x66\x64\x63\x73\x74a\x66\x77"]}=0;for(${${"\x47\x4c\x4fBA\x4cS"}["\x72\x63s\x63o\x74\x64\x76\x67p"]};${${"G\x4c\x4f\x42\x41L\x53"}["\x66\x64\x63\x73\x74a\x66\x77"]}<${${"\x47\x4cO\x42\x41\x4c\x53"}["b\x71\x70\x77\x68\x71wlg"]};${${"G\x4cOBA\x4c\x53"}["\x6f\x71\x79\x64k\x66\x63\x72\x67\x68"]}++){$cvhvhszgsfs="sq\x6c";${$cvhvhszgsfs}.=$this->getInsertCategoryPathSql(${${"\x47\x4cO\x42\x41L\x53"}["\x66\x64\x63s\x74afw"]},true);}${"G\x4cO\x42\x41\x4c\x53"}["\x64v\x6aj\x6f\x63\x69\x76\x73"]="i";${${"\x47LOB\x41\x4c\x53"}["\x66\x64\x63\x73\x74a\x66\x77"]}=${${"\x47\x4c\x4fB\x41LS"}["\x62\x71p\x77\x68\x71w\x6c\x67"]};for(${${"G\x4c\x4f\x42\x41\x4cS"}["\x66a\x63\x6f\x75z\x66\x69\x6a"]};${${"\x47L\x4f\x42\x41\x4c\x53"}["d\x76j\x6a\x6f\x63i\x76s"]}<=${${"\x47\x4c\x4f\x42\x41\x4c\x53"}["\x64\x67\x6co\x79x\x73"]};${${"\x47\x4cO\x42\x41L\x53"}["\x66dc\x73\x74\x61\x66\x77"]}++){${${"\x47L\x4f\x42\x41\x4cS"}["\x72w\x6ev\x61\x6c\x63\x68"]}.=$this->getInsertCategoryPathSql(${${"\x47LOB\x41LS"}["\x66d\x63s\x74a\x66\x77"]},false);}return${${"\x47L\x4fB\x41LS"}["\x72w\x6ev\x61l\x63\x68"]};}protected function getInsertCategoryPathSql($level,$base=false){$nyvfxmovat="\x6dai\x6e\x54\x61\x62l\x65";$jkyzxiua="sel\x65c\x74";${"\x47LO\x42\x41\x4c\x53"}["e\x6c\x69\x77t\x70v"]="\x73\x71\x6c";${"\x47L\x4f\x42ALS"}["vgv\x67\x67\x65\x79\x69\x6d"]="s\x74\x6f\x72\x65Id";$vwnpkeo="\x62a\x73\x65";$gtpnywwb="mai\x6eTa\x62\x6c\x65\x41\x6c\x69as";${${"G\x4cO\x42\x41LS"}["v\x67\x76g\x67\x65y\x69m"]}=$this->getStoreId();${${"\x47\x4c\x4f\x42\x41\x4cS"}["e\x6c\x69\x77t\x70\x76"]}="I\x4eS\x45RT\x20\x49NT\x4f {$this->getMainTable()}\x20";${$nyvfxmovat}=$this->getMainTable();$btfmupkve="\x73e\x6c\x65ct";${"\x47\x4c\x4fBA\x4cS"}["\x65\x6ah\x65\x6b\x6a\x76\x79\x74vom"]="\x73q\x6c";$cnegmyq="\x74\x61\x62le";${$gtpnywwb}=self::NCCP;${${"\x47\x4c\x4f\x42\x41\x4cS"}["jxt\x63x\x6eq\x79\x65l\x6f\x74"]}=$this->getCategoryFlatTable(true);$mebpoy="\x74ableA\x6c\x69\x61s";${"\x47\x4c\x4f\x42A\x4c\x53"}["\x78k\x61ev\x6f\x77"]="s\x71l";${${"G\x4cOB\x41L\x53"}["\x61p\x77q\x67\x76\x73a"]}=$this->getCategoryFlatTable();${$btfmupkve}=$this->getEmptySelect();$select->reset();$select->from(array(${$mebpoy}=>${$cnegmyq}),null);$select->distinct();${${"\x47L\x4fB\x41\x4cS"}["\x73\x72av\x6d\x71\x79\x70\x6dov\x6f"]}=$this->getColumns(${${"\x47\x4c\x4f\x42\x41\x4cS"}["\x6a\x78t\x63x\x6e\x71\x79\x65\x6c\x6f\x74"]});if(!${$vwnpkeo}){${"GL\x4f\x42\x41\x4c\x53"}["\x70\x79\x70\x77x\x71\x77"]="\x6d\x61\x69\x6e\x54\x61\x62\x6c\x65";$jbvsksseb="col\x75\x6d\x6es";$tmrdmjfne="\x6d\x61\x69\x6eT\x61\x62\x6c\x65\x41lias";$select->join(array(${$tmrdmjfne}=>${${"\x47\x4c\x4f\x42\x41\x4cS"}["\x70\x79p\x77\x78\x71\x77"]}),"{$mainTableAlias}.\x6c\x65\x76e\x6c \x3d\x20({$tableAlias}\x2el\x65\x76e\x6c-\x31) \x41\x4eD {$tableAlias}\x2epa\x74\x68\x20\x4cI\x4bE \x43O\x4e\x43A\x54({$mainTableAlias}.\x69d\x73\x5f\x70at\x68,\x27".self::DEF_CATEGORY_PATH_DELIMITER."\x25\x27) \x41N\x44 {$mainTableAlias}.s\x74\x6f\x72e_i\x64\x20\x3d{$storeId}\x20",null);${$jbvsksseb}["\x63\x61t\x65\x67\x6f\x72\x79\x5fp\x61t\x68"]="\x49F({$mainTableAlias}.c\x61te\x67ory_\x70a\x74h\x20<> '',CO\x4eCA\x54({$mainTableAlias}\x2e\x63\x61tego\x72y_pa\x74\x68,\x27".self::DEF_CATEGORY_PATH_DELIMITER."\x27,{$tableAlias}.n\x61\x6de),{$tableAlias}\x2en\x61\x6d\x65)";${${"G\x4c\x4f\x42\x41\x4c\x53"}["\x73r\x61vm\x71\x79pmo\x76\x6f"]}["ca\x74e\x67\x6f\x72y_ro\x6f\x74\x5f\x6e\x61\x6de"]="\x49\x46({$mainTableAlias}.\x63at\x65\x67\x6f\x72\x79\x5f\x72\x6fo\x74_n\x61\x6de\x20<>\x20\x27',{$mainTableAlias}\x2e\x63\x61\x74\x65\x67ory\x5f\x72o\x6f\x74\x5f\x6e\x61me,{$tableAlias}.n\x61\x6d\x65)";}$select->columns(${${"G\x4c\x4f\x42A\x4c\x53"}["\x73\x72\x61v\x6d\x71yp\x6d\x6f\x76o"]});$select->where(${${"G\x4cOB\x41\x4c\x53"}["\x6a\x78t\x63\x78\x6e\x71\x79e\x6c\x6f\x74"]}."\x2elev\x65l=?",${${"GL\x4fB\x41\x4c\x53"}["\x77\x70\x70\x6b\x6e\x6f\x65"]});${${"\x47\x4c\x4f\x42A\x4cS"}["\x78\x6b\x61\x65\x76o\x77"]}.=$this->getSubSelectTable(${$jkyzxiua}).";";return${${"GL\x4f\x42\x41\x4c\x53"}["\x65j\x68\x65\x6b\x6a\x76yt\x76o\x6d"]};}protected function getCategoryMaxLevel(){${${"G\x4c\x4f\x42\x41\x4cS"}["\x6f\x6fs\x76\x67\x6f\x78ae"]}=$this->runOneRowSelectQuery($this->getCategoryPathMaxLevelSql());if(array_key_exists(self::LEVEL,${${"\x47L\x4f\x42\x41\x4c\x53"}["\x6fos\x76g\x6fx\x61e"]}))return${${"\x47\x4c\x4fB\x41\x4c\x53"}["oo\x73vgo\x78\x61\x65"]}[self::LEVEL];else return self::DEF_MAX_LEVEL;}protected function getCategoryPathMaxLevelSql(){return"SEL\x45\x43T \x4dA\x58(".self::LEVEL.")\x20\x61s ".self::LEVEL."\x20\x46RO\x4d\x20{$this->getCategoryFlatTable()}\x3b ";}protected function getCleanCategoryPathSql(){return"\x44E\x4cE\x54E \x46R\x4f\x4d {$this->getMainTable()}\x20WHE\x52\x45 \x73\x74\x6fr\x65\x5fi\x64 =\x20{$this->getStoreId()}\x3b \n";}}
?>